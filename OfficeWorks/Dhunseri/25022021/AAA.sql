ac_voucherdetails_liability

SELECT * FROM TAB
WHERE upper(TNAME) LIKE upper('%GST%')

select * from ACLIABILITYDETAILS

SELECT * FROM ACGSTDETAILS

GBL_ACVOUCHER_LIB

GBL_ACGSTDETAILS_LIB

SELECT * FROM ACGSTDETAILS_LIB
WHERE SYSTEMVOUCHERNO='DTL/PB/M/19-20/0010'


SELECT FN_ROUNDOFFRS(324,10,'R') FROM DUAL


SELECT ROUND(326/10)*10 FROM DUAL


SELECT * FROM ACACLEDGER
WHERE ACCODE='22040103002'

SELECT * FROM VW_ACVOUCHERDETAILS
WHERE SYSTEMVOUCHERNO='DTL/PB/M/20-21/0011'

SELECT * FROM ACGSTDETAILS_LIB
WHERE SYSTEMVOUCHERNO='DTL/PB/M/20-21/0011'


PRCAC_LIBVOUCHER_BEFORE_MAIN


DTL/PB/M/20-21/0012


SELECT * FROM VW_ACVOUCHERDETAILS
WHERE SYSTEMVOUCHERNO='DTL/PB/M/20-21/0012'

SELECT * FROM ACGSTDETAILS_LIB
WHERE SYSTEMVOUCHERNO='DTL/PB/M/20-21/0013'

DTL/PB/M/20-21/0013

 SELECT XX.*,YY.COSTCENTREGRIDDATA,ZZ.SERVICETAXGRIDDATA,WW.GSTGRIDDATA,NVL2(WW.ACCODE,'N', DECODE( XX.ACGROUPTYPE, 'GST','Y','N') ) AUTOGSTROW  
 FROM ( 
  SELECT  
    A.ACCODE,B.ACHEAD AS PARTICULARS,A.AMOUNT,A.TDSON,
    NVL(B.COSTCENTREALLOWED,'N') AS COSTCENTREALLOWED,A.DRCR,A.TRANSACTIONTYPE ,
    B.GROUPTYPE AS ACGROUPTYPE,
    CASE WHEN A.DRCR='D' THEN A.AMOUNT ELSE 0 END AS AMOUNTDR,
    CASE WHEN A.DRCR='C' THEN A.AMOUNT ELSE 0 END AS AMOUNTCR,
    A.SYSTEMVOUCHERNO,  
    TO_CHAR(A.SYSTEMVOUCHERDATE,'DD/MM/YYYY') AS SYSTEMVOUCHERDATE,  
    A.SERIALNO,
    A.COMPANYCODE,
    A.DIVISIONCODE,
    S.DIVISIONNAME AS LOCATIONNAME,  A.DIVISIONCODEFOR AS LOCATIONCODE,
    A.YEARCODE,A.SYSROWID, 
    NVL(B.ISTDSAPPLICABLE,'N') AS TDSAPPLICABLE,B.TDSNATURE , 
    'SWT' AS USERNAME, 
    'M' AS OPERATIONMODE,B.GST_I_O_TYPE,B.GSTNATURE 
    ,NVL(Z.CASHFLOWDESC,'') CASHFLOWDESC,NVL(Z.CASHFLOWCODE,'') CASHFLOWCODE,B.ACTYPE
    FROM ACVOUCHERDETAILS_LIB A, ACACLEDGER_VW_ALL B,DIVISIONMASTER S, ACCASHFLOWMAST Z
        WHERE A.COMPANYCODE = 'DT0078' 
          AND A.DIVISIONCODE = '0001' 
          AND A.YEARCODE = '2020-2021' 
          AND A.SYSTEMVOUCHERNO='DTL/PB/M/20-21/0013'
          AND A.COMPANYCODE = B.COMPANYCODE
          AND InStr(B.DIVISIONCODE, A.DIVISIONCODE) > 0
          AND A.ACCODE=B.ACCODE 
          AND A.COMPANYCODE = S.COMPANYCODE
          AND A.DIVISIONCODEFOR = S.DIVISIONCODE
          AND A.COMPANYCODE = Z.COMPANYCODE (+)
          AND A.CASHFLOWCODE = Z.CASHFLOWCODE (+)
 )XX, 
 (
 SELECT A.ACCODEFOR,A.VOUCHERSERIALNO, 
        listagg_swt1(rownum||';'||(B.COSTCENTREDESC||'!'||A.AMOUNT||'!'||A.DRCR||'!'||A.SERIALNO||'!'||A.COSTCENTRECODE||'!'|| 
            A.COMPANYCODE||'!'||A.DIVISIONCODE||'!'||A.YEARCODE||'!'||SYSTEMVOUCHERNO||'!'||SYSTEMVOUCHERDATE||'!'||ACCODE||'!'||'M'||'!'||A.SYSROWID||'!'||A.DIVISIONCODEFOR)||'^') as COSTCENTREGRIDDATA 
  FROM ACCOSTCENTREDETAILS_LIB A, ACCOSTCENTREMAST B 
       WHERE A.COMPANYCODE = 'DT0078'
         AND A.DIVISIONCODE = '0001' 
         AND A.YEARCODE = '2020-2021' 
         AND A.SYSTEMVOUCHERNO='DTL/PB/M/20-21/0013'
         AND A.COSTCENTRECODE = B.COSTCENTRECODE
         AND A.COMPANYCODE=B.COMPANYCODE 
         AND A.DIVISIONCODEFOR=B.LOCATIONCODE
       GROUP BY  A.ACCODEFOR,A.VOUCHERSERIALNO 
 )YY, 
 ( 
 SELECT A.ACCODE,A.VOUCHERSERIALNO, 
 listagg_swt1(rownum||';'||(B.PARTYNAME||'!'||A.BILLNO||'!'||TO_CHAR(A.BILLDATE,'DD/MM/YYYY')||'!'||A.BILLAMOUNT||'!'||A.NATUREOFSERVICE||'!'||A.ABETMENTPERCENTAGE||'!'||A.COMPANYBOURNEPERCENTAGE||'!'|| 
 A.SERVICETAXON||'!'||A.SERVICETAXPERCENT||'!'||A.EDUCATIONCESSPERCENT||'!'||A.HSEDUPERCENT||'!'||A.SWACHHBHARATCESSPERCENT||'!'||A.KRISHIKALYANCESSPERCENT||'!'||A.SERVICETAXAMOUNT||'!'|| 
 A.EDUCATIONCESSAMOUNT||'!'||A.HSEDUAMOUNT||'!'||A.SWACHHBHARATCESSAMOUNT||'!'||A.KRISHIKALYANCESSAMOUNT||'!'||A.NETTAXAMOUNT||'!'||
 A.PARTYCODE||'!'||A.ACCODE||'!'||A.USERNAME||'!'||A.COMPANYCODE||'!'||A.DIVISIONCODE||'!'||A.YEARCODE||'!'||'M'||'!'||A.SYSTEMVOUCHERNO||'!'||TO_CHAR(A.SYSTEMVOUCHERDATE,'DD/MM/YYYY')||'!'||
  A.SYSROWID||'!'|| A.VOUCHERSERIALNO||'!'|| A.DIVISIONCODEFOR)||'^') as SERVICETAXGRIDDATA 
 FROM ACSERVICETAXDETAILS_LIB A, VW_AC_PARTY B
    WHERE A.COMPANYCODE = 'DT0078'
        AND A.DIVISIONCODE = '0001' 
        AND A.YEARCODE = '2020-2021' 
        AND A.SYSTEMVOUCHERNO='DTL/PB/M/20-21/0013'
        AND A.COMPANYCODE=B.COMPANYCODE 
        AND A.PARTYCODE=B.PARTYCODE
    GROUP BY  A.ACCODE,A.VOUCHERSERIALNO 
 )ZZ,
 (
 
 ACGSTDETAILS_LIB
 ACGSTDETAILS_LIB
 
  SELECT 
  A.GSTN_RECIPIENT_ADDRESS,A.GSTN_RECIPIENT_STATECODE,A.GSTN_RECIPIENT_STATENAME,A.GSTN_CONSINEE,
  A.GSTN_CONSINEE_NAME,A.GSTN_CONSINEE_ADDRESS,A.GSTN_CONSINEE_STATECODE,A.GSTN_CONSINEE_STATENAME,
  A.PLACE_OF_SUPPLY_STATECODE,A.PLACE_OF_SUPPLY_STATENAME,A.INVOICE_NO,TO_CHAR(A.INVOICE_DATE,'DD/MM/YYYY') INVOICE_DATE,
  A.DEBIT_CREDIT_NOTE_NO,
  A.DEBIT_CREDIT_NOTE_DATE,A.SHIPPING_BILL_NO,A.SHIPPING_BILL_DATE,A.IS_REVERSE_CHARGE_BY_RECIPIENT,
  A.SERIAL_NO,A.HSN_SAC_CODE,A.HSN_SAC_DESCRIPTION,A.IS_GOODS_OR_SERVICE,A.IS_EXEMPTED,A.INPUT_CREDIT_AVAILABLE,
  A.ITEM_DESCRIPTION,A.UOM,A.QUANTITY,A.RATE_PER_UNIT,A.HSN_SAC_AMOUNT,A.DISCOUNT_PER_UNIT,A.DISCOUNT_PERCENTAGE,
  A.DISCOUNT_AMOUNT,A.HSN_SAC_ASSESSABLE_AMOUNT,A.TAX_PERCENTAGE,A.IGST_RATE,A.IGST_AMOUNT,A.CGST_RATE,
  A.CGST_AMOUNT,A.SGST_RATE,A.SGST_AMOUNT,A.CESS_RATE,A.CESS_AMOUNT,A.PARTYCODE,A.SYSROWID,A.USERNAME,
  A.LASTMODIFIED,A.COMPANYCODE,A.DIVISIONCODE,A.DIVISIONCODEFOR,A.YEARCODE,A.SYSTEMVOUCHERNO,
  A.SYSTEMVOUCHERDATE,A.TRANSACTION_TYPE,A.TRANSACTION_NATURE,A.IS_TRAN_WITH_REGISTERED_PARTY,
  A.ACCODEFOR,A.ACCODE,A.VOUCHERSERIALNO,A.DRCR,A.GSTN_SENDER,A.GSTN_SENDER_NAME,A.GSTN_SENDER_ADDRESS,
  A.GSTN_SENDER_STATECODE,A.GSTN_SENDER_STATENAME,A.GSTN_RECIPIENT,A.GSTN_RECIPIENT_NAME
 FROM ACGSTDETAILS_LIB A,VW_AC_PARTY B
     WHERE A.COMPANYCODE = 'DT0078'
         AND A.DIVISIONCODE = '0001' 
         AND A.YEARCODE = '2020-2021' 
         AND A.SYSTEMVOUCHERNO='DTL/PB/M/20-21/0013' 
        AND A.COMPANYCODE=B.COMPANYCODE(+) 
        AND A.PARTYCODE=B.PARTYCODE(+)
        
     GROUP BY  A.ACCODE,A.VOUCHERSERIALNO 
     
     

SELECT WM_CONCAT('A.'||COLUMN_NAME) FROM COLS
WHERE TABLE_NAME = 'ACGSTDETAILS_LIB'


SELECT  COLUMN_NAME  FROM COLS
WHERE TABLE_NAME = 'WPSCASHOTPAYMENTDETAILS'
     
     
     
 )WW  
 WHERE XX.ACCODE = YY.ACCODEFOR (+)
   AND XX.SERIALNO = YY.VOUCHERSERIALNO (+)
   AND XX.ACCODE=ZZ.ACCODE(+)
   AND XX.SERIALNO = ZZ.VOUCHERSERIALNO (+)
   AND XX.ACCODE=WW.ACCODE(+)
   AND XX.SERIALNO = WW.VOUCHERSERIALNO (+)
  ORDER BY XX.SERIALNO   
  
  
  
SELECT C.ACHEAD PARTICULARS,D.DIVISIONNAME LOCATION,
A.GSTN_RECIPIENT_ADDRESS,A.GSTN_RECIPIENT_STATECODE,A.GSTN_RECIPIENT_STATENAME,A.GSTN_CONSINEE,
A.GSTN_CONSINEE_NAME,A.GSTN_CONSINEE_ADDRESS,A.GSTN_CONSINEE_STATECODE,A.GSTN_CONSINEE_STATENAME,
A.PLACE_OF_SUPPLY_STATECODE,A.PLACE_OF_SUPPLY_STATENAME,A.INVOICE_NO,TO_CHAR(A.INVOICE_DATE,'DD/MM/YYYY') INVOICE_DATE,
A.DEBIT_CREDIT_NOTE_NO, TO_CHAR(A.DEBIT_CREDIT_NOTE_DATE,'DD/MM/YYYY')  DEBIT_CREDIT_NOTE_DATE,A.SHIPPING_BILL_NO,
TO_CHAR(A.SHIPPING_BILL_DATE,'DD/MM/YYYY')  SHIPPING_BILL_DATE,A.IS_REVERSE_CHARGE_BY_RECIPIENT,
A.SERIAL_NO,A.HSN_SAC_CODE,A.HSN_SAC_DESCRIPTION,A.IS_GOODS_OR_SERVICE,A.IS_EXEMPTED,A.INPUT_CREDIT_AVAILABLE,
A.ITEM_DESCRIPTION,A.UOM,A.QUANTITY,A.RATE_PER_UNIT,A.HSN_SAC_AMOUNT,A.DISCOUNT_PER_UNIT,A.DISCOUNT_PERCENTAGE,
A.DISCOUNT_AMOUNT,A.HSN_SAC_ASSESSABLE_AMOUNT,A.TAX_PERCENTAGE,A.IGST_RATE,A.IGST_AMOUNT,A.CGST_RATE,
A.CGST_AMOUNT,A.SGST_RATE,A.SGST_AMOUNT,A.CESS_RATE,A.CESS_AMOUNT,A.PARTYCODE,A.SYSROWID,A.USERNAME,
A.LASTMODIFIED,A.COMPANYCODE,A.DIVISIONCODE,A.DIVISIONCODEFOR,A.YEARCODE,A.SYSTEMVOUCHERNO,
TO_CHAR(A.SYSTEMVOUCHERDATE,'DD/MM/YYYY')   SYSTEMVOUCHERDATE,A.TRANSACTION_TYPE,A.TRANSACTION_NATURE,A.IS_TRAN_WITH_REGISTERED_PARTY,
A.ACCODEFOR,A.ACCODE,A.VOUCHERSERIALNO,A.DRCR,A.GSTN_SENDER,A.GSTN_SENDER_NAME,A.GSTN_SENDER_ADDRESS,
A.GSTN_SENDER_STATECODE,A.GSTN_SENDER_STATENAME,A.GSTN_RECIPIENT,A.GSTN_RECIPIENT_NAME
FROM ACGSTDETAILS_LIB A,VW_AC_PARTY B, ACACLEDGER_VW C, divisionmaster d
WHERE A.COMPANYCODE = 'DT0078'
    AND A.DIVISIONCODE = '0001' 
    AND A.YEARCODE = '2020-2021' 
    AND A.SYSTEMVOUCHERNO='DTL/PB/M/20-21/0013' 
    AND A.COMPANYCODE=B.COMPANYCODE(+) 
    AND A.PARTYCODE=B.PARTYCODE(+)
    AND A.COMPANYCODE=C.COMPANYCODE(+) 
    AND A.ACCODE=C.ACCODE(+)
    AND A.COMPANYCODE=C.COMPANYCODE(+) 
    AND A.ACCODE=C.ACCODE(+)
    AND A.COMPANYCODE=D.COMPANYCODE(+) 
    AND A.DIVISIONCODE=D.DIVISIONCODE(+)
        
        SELECT * FROM ACACLEDGER_VW
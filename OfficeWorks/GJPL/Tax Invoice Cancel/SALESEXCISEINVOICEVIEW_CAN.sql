CREATE OR REPLACE FORCE VIEW SALESEXCISEINVOICEVIEW_CAN
(
   CHANNELCODE,
   EXCISEINVNO,
   EXCISEINVDATE,
   BROKERCODE,
   BUYERCODE,
   TRANSPORTERCODE,
   NETAMONT,
   NETINDIANAMOUNT,
   GROSSAMOUNT,
   VESSELFLIGHTNO,
   DESTINATION,
   BOOKING,
   CONTAINERNO,
   CNOTENO,
   CNOTEDATE,
   SEALNO,
   FORM1NO,
   RENO,
   TIMEOFPREPARATION,
   EXAPPLICABLE,
   EXFROM,
   EXTO,
   YEARCODE,
   COMPANYCODE,
   DIVISIONCODE,
   PROFORMAINVNO,
   PROFORMAINVDATE,
   SHIPPINGINSNO,
   SHIPPINGINSDATE,
   SAUDANO,
   SAUDADATE,
   NOOFPACKINGUNIT,
   TOTALQUANTITY,
   TOTALWEIGHT,
   PACKSHEETWEIGHT,
   GROSSWEIGHT,
   EXPORTWEIGHT,
   CONTAINERSIZE,
   TOTALAMOUNT,
   TOTALINDIANAMOUNT,
   NOFROM,
   NOTO,
   SAUDASERIALNO,
   SHIPPINGSERIALNO,
   PROFORMASERIALNO,
   EXCISESERIALNO,
   REMARKSPRO,
   REMARKS,
   ADDRESSCODE,
   ADDRESS,
   COUNTRYOFFINALDESTINATION,
   PRECARRIAGE,
   VESSELORFLIGHT,
   PORTOFDISCHARGE,
   PAYMENTCONDITION,
   PLACEOFRECEIPT,
   PORTOFLOADING,
   FINALDESTINATION,
   COUNTRYOFORIGIN,
   QUALITYCODE,
   QUALITYMANUALDESC,
   PACKINGCODE,
   PACKINGNAME,
   PACKINGSHORTNAME,
   PACKINGWEIGHT,
   PACKSTYLECODE,
   PACKSTYLENAME,
   UORCODE,
   UORNAME,
   NOCALCULATION,
   RATE,
   INDIANRATE,
   BUYERNAME,
   BROKERNAME,
   QUALITYTYPE,
   PACKINGQUANTITY,
   MEASURECODE,
   MEASURENAME,
   CURRENCYCODE,
   CURRENCYDESC,
   CONTRACTNO,
   CONTRACTDATE,
   UNITQUANTITY,
   VEHICLENO,
   TIMEOFISSUE,
   ISSUEDATE,
   REMOVALDATE,
   CHALLANNO,
   MARKS,
   SONO,
   TAREWEIGHT,
   CHANNELTAG,
   PROFORMAQUALITYMANUALDESC,
   TRADINGGPNO,
   TRADINGGPDATE,
   TRADINGGPSERIALNO,
   DIRECTTRADING,
   PRICETYPE,
   BUYERORDERDATE,
   BUYERORDERNO,
   OLDREFERENCENO,
   OUTSIDEGODOWN,
   CONTAINERTYPE,
   HBPWT,
   NETWEIGHT,
   CURRENCYSYMBOL,
   CURRENCYSIGN,
   AGAINSTEXCISEINVDATE,
   AGAINSTEXCISEINVNO,
   SYSROWID,
   WHICHFIELD,
   MEASUREUNIT,
   PADLOCKKEYNO,
   QUALITYDESCRIPTION,
   EXCISEGROUPCODE,
   QUALITYGROUPCODE,
   SUPPLYORDERNO,
   SUPPORDERDATE,
   HEADACCNTNAME,
   ISFCIPARTY,
   REFEXCISEINVNO,
   REFEXCISEINVDATE,
   INDENTORNAME,
   INDENTORADDRESS,
   HEADACCNTADDRESS,
   BROKERAGECOMM,
   FREIGHTRATE,
   SHIPPINGLINENO,
   SHIPSTATECODE,
   ADDRESSCODEBILL,
   BILLSTATECODE,
   BILLEXCHANGERATE,
   FREIGHTPAYMENT,
   INSURANCETYPE
)
AS
   SELECT                                                       /*+ ORDERED */
         M  .CHANNELCODE,
            M.EXCISEINVNO,
            M.EXCISEINVDATE,
            M.BROKERCODE,
            M.BUYERCODE,
            M.TRANSPORTERCODE,
            M.NETAMONT,
            M.NETINDIANAMOUNT,
            M.GROSSAMOUNT,
            M.VESSELFLIGHTNO,
            M.DESTINATION,
            M.BOOKING,
            M.CONTAINERNO,
            M.CNOTENO,
            M.CNOTEDATE,
            M.SEALNO,
            M.FORM1NO,
            M.RENO,
            M.TIMEOFPREPARATION,
            M.EXAPPLICABLE,
            M.EXFROM,
            M.EXTO,
            M.YEARCODE,
            M.COMPANYCODE,
            M.DIVISIONCODE,
            D.PROFORMAINVNO,
            D.PROFORMAINVDATE,
            D.SHIPPINGINSNO,
            D.SHIPPINGINSDATE,
            D.SAUDANO,
            D.SAUDADATE,
            D.NOOFPACKINGUNIT,
            D.TOTALQUANTITY,
            D.TOTALWEIGHT,
            D.PACKSHEETWEIGHT,
            D.GROSSWEIGHT,
            D.EXPORTWEIGHT,
            D.CONTAINERSIZE,
            D.TOTALAMOUNT,
            D.TOTALINDIANAMOUNT,
            D.NOFROM,
            D.NOTO,
            D.SAUDASERIALNO,
            D.SHIPPINGSERIALNO,
            D.PROFORMASERIALNO,
            D.EXCISESERIALNO,
            PV.REMARKS REMARKSPRO,
            M.REMARKS,
            M.ADDRESSCODE,
            PA.ADDRESS,
            PV.COUNTRYOFFINALDESTINATION,
            PV.PRECARRIAGE,
            PV.VESSELORFLIGHT,
            PV.PORTOFDISCHARGE,
            PV.PAYMENTCONDITION,
            PV.PLACEOFRECEIPT,
            PV.PORTOFLOADING,
            PV.FINALDESTINATION,
            PV.COUNTRYOFORIGIN,
            PV.QUALITYCODE,
            D.QUALITYMANUALDESC,
            PV.PACKINGCODE,
            PV.PACKINGNAME,
            PV.PACKINGSHORTNAME,
            PV.PACKINGWEIGHT,
            PV.PACKSTYLECODE,
            PV.PACKSTYLENAME,
            PV.UORCODE,
            PV.UORNAME,
            PV.NOCALCULATION,
            D.RATE,
            D.INDIANRATE,
            PV.BUYERNAME,
            PV.BROKERNAME,
            PV.QUALITYTYPE,
            PV.PACKINGQUANTITY,
            PV.MEASURECODE,
            PV.MEASURENAME,
            PV.CURRENCYCODE,
            PV.CURRENCYDESC,
            PV.CONTRACTNO,
            PV.CONTRACTDATE,
            PV.UNITQUANTITY,
            M.VEHICLENO,
            M.TIMEOFISSUE,
            M.ISSUEDATE,
            M.REMOVALDATE,
            M.CHALLANNO,
            D.MARKS,
            M.SONO,
            D.TAREWEIGHT,
            PV.CHANNELTAG,
            PV.QUALITYMANUALDESC PROFORMAQUALITYMANUALDESC,
            M.TRADINGGPNO,
            M.TRADINGGPDATE,
            D.TRADINGGPSERIALNO,
            M.DIRECTTRADING,
            PV.PRICETYPE,
            PV.BUYERORDERDATE,
            PV.BUYERORDERNO,
            M.OLDREFERENCENO,
            M.OUTSIDEGODOWN,
            M.CONTAINERTYPE,
            D.HBPWT,
            D.NETWEIGHT,
            SCM.CURRENCYSYMBOL,
            SCM.CURRENCYSYMBOL CURRENCYSIGN,
            M.AGAINSTEXCISEINVDATE,
            M.AGAINSTEXCISEINVNO,
            D.SYSROWID,
            PV.WHICHFIELD,
            PV.MEASUREUNIT,
            M.PADLOCKKEYNO,
            PV.QUALITYDESCRIPTION,
            PV.EXCISEGROUPCODE,
            PV.QUALITYGROUPCODE,
            PV.SUPPLYORDERNO,
            PV.SUPPORDERDATE,
            PV.HEADACCNTNAME,
            PV.ISFCIPARTY,
            M.REFEXCISEINVNO,
            M.REFEXCISEINVDATE,
            PV.INDENTORNAME,
            PV.INDENTORADDRESS,
            PV.HEADACCNTADDRESS,
            PV.BROKERAGECOMM,
            PV.FREIGHTRATE,
            M.SHIPPINGLINENO,
            PA.GSTSTATECODE SHIPSTATECODE,
            PV.ADDRESSCODEBILL,
            PV.BILLSTATECODE,
            M.BILLEXCHANGERATE,
            PV.FREIGHTPAYMENT,
            PV.INSURANCETYPE
     FROM   SALESEXCISEINVOICEMASTER_CAN M,
            SALESEXCISEINVOICEDETAILS_CAN D,
            SALESPROFORMAINVOICEVIEW PV,
            PARTYADDRESS PA,
            CURRENCYMASTER SCM
    WHERE       M.COMPANYCODE = D.COMPANYCODE
            AND M.DIVISIONCODE = D.DIVISIONCODE
            AND M.YEARCODE = D.YEARCODE
            AND M.CHANNELCODE = D.CHANNELCODE
            AND M.EXCISEINVNO = D.EXCISEINVNO
            AND M.EXCISEINVDATE = D.EXCISEINVDATE
            AND M.COMPANYCODE = PV.COMPANYCODE
            AND M.DIVISIONCODE = PV.DIVISIONCODE
            AND M.BUYERCODE = PV.BUYERCODE
            AND M.BROKERCODE = PV.BROKERCODE
            AND D.COMPANYCODE = PV.COMPANYCODE
            AND D.DIVISIONCODE = PV.DIVISIONCODE
            AND D.CHANNELCODE = PV.CHANNELCODE
            AND D.PROFORMAINVNO = PV.PROFORMAINVNO
            AND D.PROFORMAINVDATE = PV.PROFORMAINVDATE
            AND D.SHIPPINGINSNO = PV.SHIPPINGINSNO
            AND D.SHIPPINGINSDATE = PV.SHIPPINGINSDATE
            AND D.SAUDANO = PV.SAUDANO
            AND D.SAUDADATE = PV.SAUDADATE
            AND D.PROFORMASERIALNO = PV.PROFORMASERIALNO
            AND D.SHIPPINGSERIALNO = PV.SHIPPINGSERIALNO
            AND D.SAUDASERIALNO = PV.SAUDASERIALNO
            AND M.COMPANYCODE = PA.COMPANYCODE(+)
            AND M.BUYERCODE = PA.PARTYCODE(+)
            AND M.ADDRESSCODE = PA.ADDRESSCODE(+)
            AND PA.MODULE(+) = 'SALES'
            AND PV.CURRENCYCODE = SCM.CURRENCYCODE
   UNION
   SELECT                                                       /*+ ORDERED */
         M  .CHANNELCODE,
            M.DEBITCREDITNOTENO EXCISEINVNO,
            M.DEBITCREDITNOTEDATE EXCISEINVDATE,
            M.BROKERCODE,
            M.BUYERCODE,
            M.TRANSPORTERCODE,
            M.NETAMONT,
            M.NETINDIANAMOUNT,
            M.GROSSAMOUNT,
            M.VESSELFLIGHTNO,
            M.DESTINATION,
            M.BOOKING,
            M.CONTAINERNO,
            M.CNOTENO,
            M.CNOTEDATE,
            M.SEALNO,
            M.FORM1NO,
            M.RENO,
            M.TIMEOFPREPARATION,
            M.EXAPPLICABLE,
            M.EXFROM,
            M.EXTO,
            M.YEARCODE,
            M.COMPANYCODE,
            M.DIVISIONCODE,
            D.PROFORMAINVNO,
            D.PROFORMAINVDATE,
            D.SHIPPINGINSNO,
            D.SHIPPINGINSDATE,
            D.SAUDANO,
            D.SAUDADATE,
            D.NOOFPACKINGUNIT,
            D.TOTALQUANTITY,
            D.TOTALWEIGHT,
            D.PACKSHEETWEIGHT,
            D.GROSSWEIGHT,
            D.EXPORTWEIGHT,
            D.CONTAINERSIZE,
            D.TOTALAMOUNT,
            D.TOTALINDIANAMOUNT,
            D.NOFROM,
            D.NOTO,
            D.SAUDASERIALNO,
            D.SHIPPINGSERIALNO,
            D.PROFORMASERIALNO,
            D.DEBITCREDITNOTESERIALNO EXCISESERIALNO,
            PV.REMARKS REMARKSPRO,
            M.REMARKS,
            M.ADDRESSCODE,
            PA.ADDRESS,
            PV.COUNTRYOFFINALDESTINATION,
            PV.PRECARRIAGE,
            PV.VESSELORFLIGHT,
            PV.PORTOFDISCHARGE,
            PV.PAYMENTCONDITION,
            PV.PLACEOFRECEIPT,
            PV.PORTOFLOADING,
            PV.FINALDESTINATION,
            PV.COUNTRYOFORIGIN,
            PV.QUALITYCODE,
            D.QUALITYMANUALDESC,
            PV.PACKINGCODE,
            PV.PACKINGNAME,
            PV.PACKINGSHORTNAME,
            PV.PACKINGWEIGHT,
            PV.PACKSTYLECODE,
            PV.PACKSTYLENAME,
            PV.UORCODE,
            PV.UORNAME,
            PV.NOCALCULATION,
            D.RATE,
            D.INDIANRATE,
            PV.BUYERNAME,
            PV.BROKERNAME,
            PV.QUALITYTYPE,
            PV.PACKINGQUANTITY,
            PV.MEASURECODE,
            PV.MEASURENAME,
            PV.CURRENCYCODE,
            PV.CURRENCYDESC,
            PV.CONTRACTNO,
            PV.CONTRACTDATE,
            PV.UNITQUANTITY,
            M.VEHICLENO,
            M.TIMEOFISSUE,
            M.ISSUEDATE,
            M.REMOVALDATE,
            M.CHALLANNO,
            D.MARKS,
            M.SONO,
            D.TAREWEIGHT,
            PV.CHANNELTAG,
            PV.QUALITYMANUALDESC PROFORMAQUALITYMANUALDESC,
            M.TRADINGGPNO,
            M.TRADINGGPDATE,
            D.TRADINGGPSERIALNO,
            M.DIRECTTRADING,
            PV.PRICETYPE,
            PV.BUYERORDERDATE,
            PV.BUYERORDERNO,
            M.OLDREFERENCENO,
            M.OUTSIDEGODOWN,
            M.CONTAINERTYPE,
            D.HBPWT,
            D.NETWEIGHT,
            SCM.CURRENCYSYMBOL,
            SCM.CURRENCYSYMBOL CURRENCYSIGN,
            M.AGAINSTINVDATE AGAINSTEXCISEINVDATE,
            M.AGAINSTINVNO AGAINSTEXCISEINVNO,
            D.SYSROWID,
            PV.WHICHFIELD,
            PV.MEASUREUNIT,
            M.PADLOCKKEYNO,
            PV.QUALITYDESCRIPTION,
            PV.EXCISEGROUPCODE,
            PV.QUALITYGROUPCODE,
            PV.SUPPLYORDERNO,
            PV.SUPPORDERDATE,
            PV.HEADACCNTNAME,
            PV.ISFCIPARTY,
            M.REFEXCISEINVNO,
            M.REFEXCISEINVDATE,
            PV.INDENTORNAME,
            PV.INDENTORADDRESS,
            PV.HEADACCNTADDRESS,
            PV.BROKERAGECOMM,
            PV.FREIGHTRATE,
            M.SHIPPINGLINENO,
            PA.GSTSTATECODE SHIPSTATECODE,
            PV.ADDRESSCODEBILL,
            PV.BILLSTATECODE,
            M.BILLEXCHANGERATE,
            PV.FREIGHTPAYMENT,
            PV.INSURANCETYPE
     FROM   SALESDEBITCREDITNOTEMASTER M,
            SALESDEBITCREDITNOTEDTLS D,
            SALESPROFORMAINVOICEVIEW PV,
            PARTYADDRESS PA,
            CURRENCYMASTER SCM
    WHERE       M.COMPANYCODE = D.COMPANYCODE
            AND M.DIVISIONCODE = D.DIVISIONCODE
            AND M.YEARCODE = D.YEARCODE
            AND M.CHANNELCODE = D.CHANNELCODE
            AND M.DEBITCREDITNOTENO = D.DEBITCREDITNOTENO
            AND M.DEBITCREDITNOTEDATE = D.DEBITCREDITNOTEDATE
            AND M.COMPANYCODE = PV.COMPANYCODE
            AND M.DIVISIONCODE = PV.DIVISIONCODE
            AND M.BUYERCODE = PV.BUYERCODE
            AND M.BROKERCODE = PV.BROKERCODE
            AND D.COMPANYCODE = PV.COMPANYCODE
            AND D.DIVISIONCODE = PV.DIVISIONCODE
            AND D.CHANNELCODE = PV.CHANNELCODE
            AND D.PROFORMAINVNO = PV.PROFORMAINVNO
            AND D.PROFORMAINVDATE = PV.PROFORMAINVDATE
            AND D.SHIPPINGINSNO = PV.SHIPPINGINSNO
            AND D.SHIPPINGINSDATE = PV.SHIPPINGINSDATE
            AND D.SAUDANO = PV.SAUDANO
            AND D.SAUDADATE = PV.SAUDADATE
            AND D.PROFORMASERIALNO = PV.PROFORMASERIALNO
            AND D.SHIPPINGSERIALNO = PV.SHIPPINGSERIALNO
            AND D.SAUDASERIALNO = PV.SAUDASERIALNO
            AND M.COMPANYCODE = PA.COMPANYCODE(+)
            AND M.BUYERCODE = PA.PARTYCODE(+)
            AND M.ADDRESSCODE = PA.ADDRESSCODE(+)
            AND PA.MODULE(+) = 'SALES'
            AND PV.CURRENCYCODE = SCM.CURRENCYCODE;



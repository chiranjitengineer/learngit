SELECT WORKERSERIAL, TOKENNO,YEARMONTH, TO_CHAR(TO_DATE(YEARMONTH,'YYYYMM'),'MON-YY') 
MONTH_AMT ,BASIC FROM PISPAYTRANSACTION
WHERE TOKENNO='11004'


select * from (
   SELECT WORKERSERIAL, TOKENNO,YEARMONTH,NVL(BASIC,0) BASIC FROM PISPAYTRANSACTION
    WHERE 1=1 --TOKENNO IN ('11004','01122')
    ORDER BY YEARMONTH
)
pivot 
(
   SUM(BASIC)
   for YEARMONTH in ('202004'  APR,'202005'  MAY,'202006'  JUN,'202007'  JUL,'202008'  AUG,'202009'  SEP,'202010'  OCT,'202011'  NOV,'202012'  DEC,'202101'  JAN,'202102'  FEB,'202103'  MAR)
)

order by 1


SELECT TO_CHAR(MM,'YYYYMM') YYYYMM,TO_CHAR(MM,'MON') MM 
FROM 
(
    SELECT ADD_MONTHS(TO_DATE('01/04/2020','DD/MM/YYYY'), LEVEL-1) MM 
    FROM DUAL CONNECT BY LEVEL <= 12
)


SELECT * FROM FINANCIALYEAR


SELECT WM_CONCAT(''''||YYYYMM||'''  '||MM) 
FROM 
(
    SELECT TO_CHAR(MM,'YYYYMM') YYYYMM,TO_CHAR(MM,'MON') MM 
    FROM 
    (
        SELECT ADD_MONTHS(TO_DATE('01/04/2020','DD/MM/YYYY'), LEVEL-1) MM 
        FROM DUAL CONNECT BY LEVEL <= 12
    )
)


ACC_YEAR    EMP_CD    EMP_NAME    RETIREDCD    RETIRED DATE    UNIT CD    DEPT_CD



SELECT A.COMPANYCODE, A.DIVISIONCODE, A.WORKERSERIAL, A.TOKENNO,
B.EMPLOYEENAME, A.UNITCODE, A.DEPARTMENTCODE, A.BASIC
FROM PISPAYTRANSACTION A, PISEMPLOYEEMASTER B
WHERE A.COMPANYCODE=B.COMPANYCODE
AND A.DIVISIONCODE=B.DIVISIONCODE
AND A.WORKERSERIAL=B.WORKERSERIAL


SELECT * FROM PISEMPLOYEEMASTER


 SELECT A.COMPANYCODE, A.DIVISIONCODE, A.WORKERSERIAL, A.TOKENNO, A.YEARMONTH,
    B.EMPLOYEENAME, A.UNITCODE, A.DEPARTMENTCODE, A.BASIC
    FROM PISPAYTRANSACTION A, PISEMPLOYEEMASTER B
    WHERE A.COMPANYCODE=B.COMPANYCODE
    AND A.DIVISIONCODE=B.DIVISIONCODE
    AND A.WORKERSERIAL=B.WORKERSERIAL
    
    
    
CREATE TABLE GTT_MONTHLY_BONUS AS


SELECT * FROM 
(
    SELECT WORKERSERIAL, TOKENNO,YEARMONTH,NVL(BASIC,0) BASIC FROM PISPAYTRANSACTION
    WHERE 1=1 --TOKENNO IN ('11004','01122')
    AND YEARCODE='2020-2021'
    ORDER BY YEARMONTH
)
PIVOT 
(
   SUM(BASIC)
   FOR YEARMONTH IN ('202004'  APR,'202005'  MAY,'202006'  JUN,'202007'  JUL,'202008'  AUG,'202009'  SEP,'202010'  OCT,'202011'  NOV,'202012'  DEC,'202101'  JAN,'202102'  FEB,'202103'  MAR)
)



SELECT B.COMPANYCODE,B.DIVISIONCODE,B.UNITCODE, B.CATEGORYCODE,B.GRADECODE,
B.DEPARTMENTCODE,B.EMPLOYEENAME,
A.WORKERSERIAL, A.TOKENNO, A.APR_AMT, A.MAY_AMT, A.JUN_AMT, A.JUL_AMT, A.AUG_AMT, A.SEP_AMT, 
A.OCT_AMT, A.NOV_AMT, A.DEC_AMT, A.JAN_AMT, A.FEB_AMT, A.MAR_AMT
 FROM GTT_MONTHLY_BONUS A, PISEMPLOYEEMASTER B
WHERE A.WORKERSERIAL=B.WORKERSERIAL

SELECT * FROM COMPANYMAST


EXEC PROC_RPT_MONTHLYBONUS_EXL('BJ0056','0002','2020-2021','01/04/2020','31/03/2021')


EXEC PROC_RPT_MONTHLYBONUS_EXL('BJ0056','0001','2020-2021') 



SELECT * FROM GTT_MONTHLY_BONUS

UPDATE GTT_MONTHLY_BONUS SET
APR_BONUS = CASE WHEN APR_AMT > 7000 THEN 7000 ELSE APR_AMT END,
MAY_BONUS = CASE WHEN MAY_AMT > 7000 THEN 7000 ELSE MAY_AMT END,
JUN_BONUS = CASE WHEN JUN_AMT > 7000 THEN 7000 ELSE JUN_AMT END,
JUL_BONUS = CASE WHEN JUL_AMT > 7000 THEN 7000 ELSE JUL_AMT END,
AUG_BONUS = CASE WHEN AUG_AMT > 7000 THEN 7000 ELSE AUG_AMT END,
SEP_BONUS = CASE WHEN SEP_AMT > 7000 THEN 7000 ELSE SEP_AMT END,
OCT_BONUS = CASE WHEN OCT_AMT > 7000 THEN 7000 ELSE OCT_AMT END,
NOV_BONUS = CASE WHEN NOV_AMT > 7000 THEN 7000 ELSE NOV_AMT END,
DEC_BONUS = CASE WHEN DEC_AMT > 7000 THEN 7000 ELSE DEC_AMT END,
JAN_BONUS = CASE WHEN JAN_AMT > 7000 THEN 7000 ELSE JAN_AMT END,
FEB_BONUS = CASE WHEN FEB_AMT > 7000 THEN 7000 ELSE FEB_AMT END,
MAR_BONUS = CASE WHEN MAR_AMT > 7000 THEN 7000 ELSE MAR_AMT END;









INSERT INTO GTT_MONTHLY_BONUS
(
    WORKERSERIAL, TOKENNO, APR_AMT, MAY_AMT, JUN_AMT, JUL_AMT, AUG_AMT, SEP_AMT, OCT_AMT, NOV_AMT, DEC_AMT, JAN_AMT, FEB_AMT, MAR_AMT
)


SELECT * FROM 
(
    SELECT WORKERSERIAL, TOKENNO,YEARMONTH,NVL(BASIC,0) BASIC, SUM(ATTN_SALD) WORKDAYS FROM PISPAYTRANSACTION
    WHERE 1=1 
    AND YEARCODE='2020-2021'
    ORDER BY YEARMONTH
)
PIVOT 
(
   SUM(BASIC)
   FOR YEARMONTH IN ('202004'  APR,'202005'  MAY,'202006'  JUN,'202007'  JUL,'202008'  AUG,'202009'  SEP,'202010'  OCT,'202011'  NOV,'202012'  DEC,'202101'  JAN,'202102'  FEB,'202103'  MAR)
)


SELECT * FROM MENUMASTER_RND
WHERE UPPER(MENUDESC) LIKE UPPER('%UNREA%')

SELECT * FROM MENUMASTER_RND
WHERE MENUCODE='0107030329'

SELECT * FROM ROLEDETAILS
WHERE MENUCODE='0107030329'

SELECT * FROM REPORTPARAMETERMASTER
WHERE REPORTTAG=''


SELECT DATEOFRETIRE FROM PISEMPLOYEEMASTER


SELECT WORKERSERIAL, SUM(ATTN_SALD) WORKDAYS FROM PISPAYTRANSACTION
WHERE YEARCODE='2020-2021'
GROUP BY WORKERSERIAL


     SELECT 0 SERIAL_NO,B.COMPANYCODE,B.DIVISIONCODE,B.UANNO, B.TOKENNO, WORKERNAME, PENSIONNO, PFNO, B.DATEOFBIRTH, SUM(NVL(GROSS_WAGES,0)) GROSSWAGES, SUM(NVL(PF_GROSS,0)) PF_GROSS, 
     CASE WHEN SUM(NVL(PENSION_GROSS,0)) >=15000 THEN 15000 ELSE SUM(NVL(PENSION_GROSS,0)) END PENSION_GROSS, CASE WHEN SUM(NVL(PF_GROSS,0)) >= 15000 THEN 15000 ELSE SUM(NVL(PF_GROSS,0)) END DLI_GROSS, SUM(NVL(FPF,0)) AS PENSION_CONTRIBUTION,0 EPF_EE,0 EE_REFUND, 
     CASE WHEN ROUND(((SUM(NVL(ATTENDANCEHOURS,0)+NVL(NS_HRS_PFLINK,0)+NVL(HOLIDAYHOURS,0)+NVL(STLHOURS,0))))/8,0) >= 31 THEN 0 
     ELSE 
       31 - ROUND(((SUM(NVL(ATTENDANCEHOURS,0)+NVL(NS_HRS_PFLINK,0)+NVL(HOLIDAYHOURS,0)+NVL(STLHOURS,0))))/8,0) 
     END NCPDAYS, 
     B.DATEOFTERMINATIONADVICE DOL, 
     CASE WHEN B.DATEOFTERMINATIONADVICE IS NULL OR B.DATEOFTERMINATIONADVICE > TO_DATE('31/01/2021','DD/MM/YYYY') THEN '' 
     ELSE   WORKERSTATUS  
     END REASON,  
     0 WAGE_ARR, 0 EE_ARR, 0 ER_ARR, 0 EPS_ARR,        
     CASE WHEN  B.PFAPPLICABLE='Y' AND B.EPFAPPLICABLE='Y' THEN '2'       
          WHEN  B.PFAPPLICABLE='Y' AND B.EPFAPPLICABLE='N' THEN '1'      
          ELSE '3'      
     END AS PFCATEGORY,               
     B.ADHARCARDNO AADHARNO,'WPS' MODULE 
     FROM (  
             SELECT COMPANYCODE, DIVISIONCODE, WORKERSERIAL,NVL(GROSS_WAGES,0) GROSS_WAGES, NVL(PF_GROSS,0) PF_GROSS, NVL(PENSION_GROSS,0) PENSION_GROSS, NVL(FPF,0) FPF, NVL(PF_CONT,0) PF_CONT,  
             NVL(ATTENDANCEHOURS,0) ATTENDANCEHOURS, NVL(NS_HRS_PFLINK,0) NS_HRS_PFLINK, NVL(HOLIDAYHOURS,0) HOLIDAYHOURS, 0 STLHOURS  
             FROM WPSWAGESDETAILS_MV   
             WHERE COMPANYCODE= 'NJ0001' AND DIVISIONCODE='0002'  
               AND YEARCODE ='2020-2021'   
               and tokenno='85130'
               AND FORTNIGHTSTARTDATE >= TO_DATE('01/01/2021','DD/MM/YYYY') AND FORTNIGHTENDDATE <=  TO_DATE('31/01/2021','DD/MM/YYYY')  
          ) A, WPSWORKERMAST B  
     WHERE A.WORKERSERIAL (+)= B.WORKERSERIAL 
        and b.tokenno='85130'
         AND B.WORKERCATEGORYCODE NOT IN ('A','O','R') 
         AND B.DATEOFJOINING <= TO_DATE('31/01/2021','DD/MM/YYYY') 
         AND (B.DATEOFTERMINATION IS NULL OR B.DATEOFTERMINATION >= TO_DATE('01/01/2021','DD/MM/YYYY'))
     AND PFMEMBERSHIPDATE<=TO_DATE('31/01/2021','DD/MM/YYYY') 
     AND (PFSETTELMENTDATE IS NULL OR PFSETTELMENTDATE >TO_DATE('31/01/2021','DD/MM/YYYY')) 
     GROUP BY B.COMPANYCODE,B.DIVISIONCODE,B.UANNO, B.TOKENNO, WORKERNAME, PENSIONNO, PFNO, B.DATEOFBIRTH,B.PFCATEGORY,B.ADHARCARDNO,B.DATEOFTERMINATIONADVICE,WORKERSTATUS,B.PFAPPLICABLE,B.EPFAPPLICABLE
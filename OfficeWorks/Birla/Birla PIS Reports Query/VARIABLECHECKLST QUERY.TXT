

SELECT * FROM MENUMASTER_RND
WHERE MENUcode LIKE '010703031%'



SELECT * FROM ROLEDETAILS
WHERE MENUcode LIKE '0107030318'


SET DEFINE OFF;
Insert into BIRLANEW.MENUMASTER_RND
   (MENUCODE, MENUDESC, MENUTYPE, MENUTAG, MENUTAG1, MENUTAG2, ENTRYPOSSIBLE, EDITPOSSIBLE, DELETEPOSSIBLE, REPORTSPOSSIBLE, UTILITIESPOSSIBLE, ACTIVE, PROJECTNAME, EFFECTIVEINDIVISION, URLSRC)
 Values
    ('0107030319', 'Variable Check List', 'REPORTS', 'PIS EXCEL REPORT BIRLA', 'VARIABLE CHECK LIST', 'PROC_RPT_VARIABLECHECKLST_EXL(''COMPANYCODE'',''DIVISIONCODE'',''YEARCODE'',''txtYEARMONTH'',''btnUnit'',''btnCategory'') ', 'N', 'N', 'N', 'Y', 'N', 'Y', 'PIS', '''0001'',''0003'',''0002'',''0004''', 'PIS/Pages/Report/pgReportPISTemplate.aspx');
COMMIT;


SET DEFINE OFF;
Insert into BIRLANEW.ROLEDETAILS
   (ROLEID, MENUCODE, ACCESSENTRY, ACCESSEDIT, ACCESSDELETE, ACCESSREPORT, ACCESSUTILITIES, ACCESSVIEW, ACCESSPRINT, PROJECTNAME, SYSROWID)
 Values
   ('59', '0107030319', 'X', 'X', 'X', 'Y', 'X', 'X', 'X', 'PIS', '202009041631020011148979');
Insert into BIRLANEW.ROLEDETAILS
   (ROLEID, MENUCODE, ACCESSENTRY, ACCESSDELETE, ACCESSREPORT, ACCESSUTILITIES, ACCESSVIEW, ACCESSPRINT, PROJECTNAME, SYSROWID)
 Values
   ('52', '0107030319', 'X', 'X', 'Y', 'X', 'X', 'X', 'PIS', '202005070846440010402103');
Insert into BIRLANEW.ROLEDETAILS
   (ROLEID, MENUCODE, ACCESSENTRY, ACCESSDELETE, ACCESSREPORT, ACCESSUTILITIES, ACCESSVIEW, ACCESSPRINT, PROJECTNAME, SYSROWID)
 Values
   ('54', '0107030319', 'X', 'X', 'Y', 'X', 'X', 'X', 'PIS', '202003131131450010180969');
Insert into BIRLANEW.ROLEDETAILS
   (ROLEID, MENUCODE, ACCESSENTRY, ACCESSDELETE, ACCESSREPORT, ACCESSUTILITIES, ACCESSVIEW, ACCESSPRINT, PROJECTNAME, SYSROWID)
 Values
   ('1', '0107030319', 'X', 'X', 'Y', 'X', 'X', 'X', 'PIS', '202005081119420010404594');
COMMIT;


EXEC PROC_RPT_VARIABLECHECKLST_EXL('BJ0056','0001','2020-2021','202009') 
 

SELECT B.UNITSHORTDESC FROM  GTT_VARIABLECHECKLIST_REP A, PISUNITMASTER B
WHERE A.COMPANYCODE = B.COMPANYCODE
AND A.DIVISIONCODE=B.DIVISIONCODE
AND A.UNITCODE=B.UNITCODE


SELECT * FROM  GTT_EXCEL_REPORT





SELECT WM_CONCAT(COMPONENTCODE) FROM PISCOMPONENTMASTER
WHERE COMPONENTTYPE='DEDUCTION'

SELECT WM_CONCAT('SUM('||COMPONENTCODE||') '||COMPONENTCODE) 
FROM PISCOMPONENTMASTER
WHERE COMPONENTTYPE='DEDUCTION'


ESI_E,PF_E,PTAX,LWF,VPF,ITAX,LIC,ELECTRIC,OTHR_DEDN,LOAN_BL,LINT_BL,LOAN_STADV,LINT_STADV,LOAN_SA,
LINT_SA,CAR,CHOWKIDARI,FURNITURE,CLUB,LOAN_PFL,LINT_PFL,LOTTERY,RECREATION,GAMES,SCHOOL_BUS,DAIRY,
LIBRARY,LADIESCLUB,SUBSCRIPTION,HR_DEDN,SAL_ADV,LOAN_HPF,LINT_HPF,COMPSAVING


SELECT * FROM PISPAYTRANSACTION

DELETE FROM GTT_VARIABLECHECKLIST_REP WHERE 1=1;

INSERT INTO GTT_VARIABLECHECKLIST_REP
(
    COMPANYCODE, DIVISIONCODE, UNITCODE, COMPONENTCODE, COMPONENTDESC, COMPONENTAMT
)

SELECT COMPANYCODE,DIVISIONCODE,UNITCODE, A.COMPONENTCODE,COMPONENTDESC, COMPONENTAMT FROM 
(
    SELECT UNITCODE,COMPONENTCODE,COMPONENTAMT  FROM 
    (
        SELECT UNITCODE,SUM(ESI_E) ESI_E,SUM(PF_E) PF_E,SUM(PTAX) PTAX,SUM(LWF) LWF,SUM(VPF) VPF,
        SUM(ITAX) ITAX,SUM(LIC) LIC,SUM(ELECTRIC) ELECTRIC,SUM(OTHR_DEDN) OTHR_DEDN,
        SUM(LOAN_BL) LOAN_BL,SUM(LINT_BL) LINT_BL,SUM(LOAN_STADV) LOAN_STADV,SUM(LINT_STADV) LINT_STADV,
        SUM(LOAN_SA) LOAN_SA,SUM(LINT_SA) LINT_SA,SUM(CAR) CAR,SUM(CHOWKIDARI) CHOWKIDARI,
        SUM(FURNITURE) FURNITURE,SUM(CLUB) CLUB,SUM(LOAN_PFL) LOAN_PFL,SUM(LINT_PFL) LINT_PFL,
        SUM(LOTTERY) LOTTERY,SUM(RECREATION) RECREATION,SUM(GAMES) GAMES,SUM(SCHOOL_BUS) SCHOOL_BUS,
        SUM(DAIRY) DAIRY,SUM(LIBRARY) LIBRARY,SUM(LADIESCLUB) LADIESCLUB,SUM(SUBSCRIPTION) SUBSCRIPTION,
        SUM(HR_DEDN) HR_DEDN,SUM(SAL_ADV) SAL_ADV,SUM(LOAN_HPF) LOAN_HPF,SUM(LINT_HPF) LINT_HPF,SUM(COMPSAVING) COMPSAVING
        FROM PISPAYTRANSACTION 
        WHERE 1=1-- TOKENNO ='11004'
        AND COMPANYCODE='BJ0056'
        AND DIVISIONCODE='0001'
        AND YEARMONTH='202009'
        GROUP BY UNITCODE
    )
    UNPIVOT(
        COMPONENTAMT
        FOR COMPONENTCODE IN
        (
            ESI_E,PF_E,PTAX,LWF,VPF,ITAX,LIC,ELECTRIC,OTHR_DEDN,LOAN_BL,LINT_BL,LOAN_STADV,LINT_STADV,
            LOAN_SA,LINT_SA,CAR,CHOWKIDARI,FURNITURE,CLUB,LOAN_PFL,LINT_PFL,LOTTERY,RECREATION,GAMES,
            SCHOOL_BUS,DAIRY,LIBRARY,LADIESCLUB,SUBSCRIPTION,HR_DEDN,SAL_ADV,LOAN_HPF,LINT_HPF,COMPSAVING
        )
    )
) A, PISCOMPONENTMASTER B
WHERE A.COMPONENTCODE=B.COMPONENTCODE
AND COMPONENTAMT > 0

 

SELECT ROW_NUMBER() OVER (PARTITION BY UNITCODE ORDER BY UNITCODE,COMPONENTCODE) SLNO,
COMPANYCODE, DIVISIONCODE, UNITCODE, COMPONENTCODE, COMPONENTDESC, COMPONENTAMT 
FROM GTT_VARIABLECHECKLIST_REP
ORDER BY UNITCODE, COMPONENTCODE
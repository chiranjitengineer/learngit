SELECT * FROM 
(
    SELECT SUM(FBASIC_PEICERT) FBASIC_PEICERT, SUM(FBASIC) FBASIC
    , SUM(VBASIC) VBASIC, SUM(DA) DA, SUM(TSA) TSA, SUM(ADHOC) ADHOC, SUM(NS_ALLOW) NS_ALLOW
    FROM 
    (
        SELECT COMPONENT.TOKENNO, FORTNIGHTSTARTDATE,FORTNIGHTENDDATE,
        COMPONENT.FBASIC_PEICERT, COMPONENT.FBASIC,COMPONENT.VBASIC ,COMPONENT.DA,
        COMPONENT.TSA,COMPONENT.ADHOC , (CASE WHEN SECMST.PFLINKHOURS >0 THEN COMPONENT.NS_ALLOW ELSE 0 END) NS_ALLOW ,
        --
        COMPONENT.FBASIC_PEICERT+ COMPONENT.FBASIC +COMPONENT.VBASIC +COMPONENT.DA+
        COMPONENT.TSA+COMPONENT.ADHOC + (CASE WHEN SECMST.PFLINKHOURS >0 THEN COMPONENT.NS_ALLOW ELSE 0 END) TOTAL_SUM
        FROM WPSWAGESDETAILS COMPONENT, VW_WPSSECTIONMAST  SECMST,
        (
            SELECT (MAX(FORTNIGHTENDDATE)-33) STARTDATE,MAX(FORTNIGHTENDDATE) ENDDATE  FROM WPSWAGESDETAILS WHERE TOKENNO='00046'
        ) MAXDATE
        WHERE TOKENNO='00046' --'04053'
        AND COMPONENT.SECTIONCODE=SECMST.SECTIONCODE
        AND COMPONENT.COMPANYCODE=SECMST.COMPANYCODE
        AND COMPONENT.DIVISIONCODE=SECMST.DIVISIONCODE
        AND COMPONENT.DEPARTMENTCODE=SECMST.DEPARTMENTCODE
        -- AND FORTNIGHTENDDATE BETWEEN (TO_DATE('31/03/2020','DD/MM/YYYY') - 20) AND TO_DATE('31/03/2020','DD/MM/YYYY')
        -- AND FORTNIGHTENDDATE BETWEEN MAXDATE.STARTDATE AND MAXDATE.ENDDATE
        AND FORTNIGHTENDDATE IN 
        (
            SELECT FORTNIGHTENDDATE FROM 
            (
                SELECT ROW_NUMBER() OVER (ORDER BY FORTNIGHTENDDATE DESC) RNO, 
                FORTNIGHTENDDATE  FROM WPSWAGESDETAILS WHERE TOKENNO='00046'
                GROUP BY FORTNIGHTENDDATE
            )
            WHERE RNO <= 8
            --     ORDER BY FORTNIGHTENDDATE DESC
        )
    )
    GROUP BY TOKENNO
)sale_stats
UNPIVOT(
    COMPONENTVALUE  -- unpivot_clause
    FOR COMPONENTCODE --  unpivot_for_clause
    IN ( -- unpivot_in_clause
        FBASIC_PEICERT AS 'FBASIC_PEICERT', 
        FBASIC AS 'FBASIC', 
        VBASIC AS 'VBASIC', 
        DA AS 'DA', 
        TSA AS 'TSA', 
        ADHOC AS 'ADHOC', 
        NS_ALLOW AS 'NS_ALLOW'
    )
);

FBASIC_PEICERT, SUM(FBASIC) FBASIC
    , SUM(VBASIC) VBASIC, SUM(DA) DA, SUM(TSA) TSA, SUM(ADHOC) ADHOC, SUM(ADHOC) NS_ALLOW
    
SELECT * FROM QUERYMASTER    


SELECT FN_GET_FORM_QRY_WEB (38, 'COMPANYCODE:NJ0001~DIVISIONCODE:0002~TOKENNO:04053' ) FROM DUAL 


SELECT CALENDARYEAR YEAR,TOTAL TOTALDAYS,GRATURITYENTILE 
FROM GRATUITYENTITLEMENTYEAR
WHERE TOKENNO=<<TOKENNO>>
AND COMPANYCODE='NJ0001'
AND DIVISIONCODE='0002'
ORDER BY CALENDARYEAR
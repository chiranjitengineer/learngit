CREATE TABLE NEW_SAL_ARR_SOUTH
(
    TOKENNO	    VARCHAR2(10),
    NAME	    VARCHAR2(200),
    OLD_SAL	    NUMBER(15,2),
    NEW_SAL		    NUMBER(15,2),
    ARR_SAL		    NUMBER(15,2),
    ARR_SAL_TOT		    NUMBER(15,2),
    OLD_HRA		    NUMBER(15,2),
    NEW_HRA		    NUMBER(15,2),
    ARR_HRA		    NUMBER(15,2),
    ARR_HRA_TOT		    NUMBER(15,2),
    GROSSEARN		    NUMBER(15,2),
    PF_PERC		    NUMBER(15,2),
    PF_E		    NUMBER(15,2),
    VPF_PERC		    NUMBER(15,2),
    VPF		    NUMBER(15,2),
    TOTAL_PF		    NUMBER(15,2),
    NETSALARY	    NUMBER(15,2)
)

SELECT * FROM NEW_SAL_ARR_SOUTH
HRA_GROSS,HRA


SELECT * FROM PISARREARTRANSACTION
WHERE YEARMONTH='202010'

HRA_GROSS,HRA



INSERT INTO PISARREARTRANSACTION
(
    COMPANYCODE, DIVISIONCODE, YEARCODE, YEARMONTH, UNITCODE, DEPARTMENTCODE, CATEGORYCODE, GRADECODE, WORKERSERIAL, TOKENNO, TRANSACTIONTYPE, PAYMODE,
    BASIC,HRA_GROSS,HRA,PF_GROSS,PF_E,PF_C,VPF,GROSSEARN,GROSSDEDN,NETSALARY
)
--
SELECT COMPANYCODE, DIVISIONCODE,'2020-2021' YEARCODE,'202010' YEARMONTH, UNITCODE, DEPARTMENTCODE, CATEGORYCODE, 
GRADECODE, WORKERSERIAL, A.TOKENNO,'ARREAR' TRANSACTIONTYPE,'BANK' PAYMODE,
ARR_SAL_TOT BASIC,ARR_SAL_TOT HRA_GROSS,ARR_HRA_TOT HRA,PF_GROSS,PF_E,PF_C,VPF,GROSSEARN, (PF_E+VPF) GROSSDEDN,NETSALARY
FROM PISEMPLOYEEMASTER A,
(
    SELECT A.TOKENNO,A.ARR_SAL_TOT,ARR_HRA_TOT, NVL(ARR_SAL_TOT,0) PF_GROSS, NVL(PF_E,0) PF_E,NVL(PF_E,0) PF_C, NVL(VPF,0) VPF ,
    GROSSEARN ,NETSALARY   
    FROM NEW_SAL_ARR_SOUTH A 
) B
WHERE A.TOKENNO=B.TOKENNO





 SELECT A.TOKENNO,A.ARR_SAL_TOT BASIC,ARR_HRA_TOT, NVL(ARR_SAL_TOT,0) PF_GROSS, NVL(PF_E,0) PF_E,NVL(PF_E,0) PF_C, NVL(VPF,0) VPF 
    FROM NEW_SAL_ARR_SOUTH A 
SELECT COMPANYCODE, DIVISIONCODE, YEARCODE, YEARMONTH, CATEGORYCODE, GRADECODE, EMPLOYEECODE, PFNO,
SUM(ATTN_SALD) ATTN_SALD, SUM(NCP_DAYS) NCP_DAYS, SUM(GROSSWAGES) GROSSWAGES, SUM(PF_GROSS) PF_GROSS,
CASE WHEN SUM(EPF)<=0 then 0 ELSE CASE WHEN SUM(PF_GROSS)>=15000 THEN 15000 ELSE SUM(PF_GROSS) END END PEN_GROSS,
SUM(ESI_GROSS) ESI_GROSS, SUM(PTAX_GROSS) PTAX_GROSS, SUM(PF_E) PF_E, SUM(EPF) EPF, SUM(PF_C) PF_C, SUM(PTAX) PTAX,
SUM(ESI_E) ESI_E, SUM(ESI_C) ESI_C, SUM(LOAN_MPL) LOAN_MPL, SUM(LINT_MPL) LINT_MPL
FROM (
        SELECT A.COMPANYCODE, A.LOCATIONCODE DIVISIONCODE, A.YEARCODE, A.YEARMONTH, A.CATEGORYCODE, A.GRADECODE,A.EMPLOYEECODE, B.EMPLOYEEPFACCNUMBER PFNO,
        DECODE(A.COMPONENTCODE,'ATTN.TOTD', COMPONENTAMOUNT,0) ATTN_SALD, DECODE(A.COMPONENTCODE,'ATTN.WPAY', COMPONENTAMOUNT,0) NCP_DAYS,
        DECODE(A.COMPONENTCODE,'GROSSEARN', COMPONENTAMOUNT,0) GROSSWAGES,DECODE(A.COMPONENTCODE,'PFGROSS', COMPONENTAMOUNT,0) PF_GROSS, 
        DECODE(A.COMPONENTCODE,'GROSS_ESI', COMPONENTAMOUNT,0) ESI_GROSS, DECODE(A.COMPONENTCODE,'GROSSPTAX', COMPONENTAMOUNT,0) PTAX_GROSS,
        DECODE(A.COMPONENTCODE,'PF_E', COMPONENTAMOUNT,0) PF_E, DECODE(A.COMPONENTCODE,'EPF', COMPONENTAMOUNT,0) EPF,
        DECODE(A.COMPONENTCODE,'PF_C', COMPONENTAMOUNT,0) PF_C, DECODE(A.COMPONENTCODE,'PTAX', COMPONENTAMOUNT,0) PTAX,
        DECODE(A.COMPONENTCODE,'ESI_E', COMPONENTAMOUNT,0) ESI_E, DECODE(A.COMPONENTCODE,'ESI_C', COMPONENTAMOUNT,0) ESI_C,
        DECODE(A.COMPONENTCODE,'LOAN.PFL', COMPONENTAMOUNT,0) LOAN_MPL, DECODE(A.COMPONENTCODE,'LINT.PFL', COMPONENTAMOUNT,0) LINT_MPL
        FROM PISEMPLOYEEPAYTRANSACTION A, PISEMPLOYEEMASTER B
        WHERE A.COMPANYCODE='NJ0001' AND A.LOCATIONCODE='0002'
          AND A.YEARMONTH='202004'
          AND A.COMPONENTCODE IN ('ATTN.TOTD','ATTN.WPAY','GROSSEARN','PFGROSS','GROSS_ESI', 'GROSSPTAX','PF_E','EPF','PF_C','PTAX','ESI_E','ESI_C','LOAN.PFL','LINT.PFL')
          AND A.COMPANYCODE= B.COMPANYCODE AND A.LOCATIONCODE=B.LOCATIONCODE AND A.EMPLOYEECODE=B.EMPLOYEECODE       
        UNION ALL
        SELECT A.COMPANYCODE, A.LOCATIONCODE DIVISIONCODE, A.YEARCODE, A.YEARMONTH, A.CATEGORYCODE, A.GRADECODE, A.EMPLOYEECODE, B.EMPLOYEEPFACCNUMBER PFNO,
        DECODE(A.COMPONENTCODE,'ATTN.TOTD', COMPONENTAMOUNT,0) ATTN_SALD, DECODE(A.COMPONENTCODE,'ATTN.WPAY', COMPONENTAMOUNT,0) NCP_DAYS,
        DECODE(A.COMPONENTCODE,'GROSSEARN', COMPONENTAMOUNT,0) GROSSWAGES,DECODE(A.COMPONENTCODE,'PFGROSS', COMPONENTAMOUNT,0) PF_GROSS, 
        DECODE(A.COMPONENTCODE,'GROSS_ESI', COMPONENTAMOUNT,0) ESI_GROSS, DECODE(A.COMPONENTCODE,'GROSSPTAX', COMPONENTAMOUNT,0) PTAX_GROSS,
        DECODE(A.COMPONENTCODE,'PF_E', COMPONENTAMOUNT,0) PF_E, DECODE(A.COMPONENTCODE,'EPF', COMPONENTAMOUNT,0) EPF,
       DECODE(A.COMPONENTCODE,'PF_C', COMPONENTAMOUNT,0) PF_C, DECODE(A.COMPONENTCODE,'PTAX', COMPONENTAMOUNT,0) PTAX,
        DECODE(A.COMPONENTCODE,'ESI_E', COMPONENTAMOUNT,0) ESI_E, DECODE(A.COMPONENTCODE,'ESI_C', COMPONENTAMOUNT,0) ESI_C,
        DECODE(A.COMPONENTCODE,'LOAN.PFL', COMPONENTAMOUNT,0) LOAN_MPL, DECODE(A.COMPONENTCODE,'LINT.PFL', COMPONENTAMOUNT,0) LINT_MPL
        FROM PISEMPLOYEEPAYTRANSACTION A, PISEMPLOYEEMASTER B
        WHERE A.COMPANYCODE='NJ0001' AND A.LOCATIONCODE='0001'
          AND A.YEARMONTH='202004'
          AND A.CATEGORYCODE='2'
          AND A.COMPONENTCODE IN ('ATTN.TOTD','ATTN.WPAY','GROSSEARN','PFGROSS','GROSS_ESI', 'GROSSPTAX','PF_E','EPF','PF_C','PTAX','ESI_E','ESI_C','LOAN.PFL','LINT.PFL')
          AND A.COMPANYCODE= B.COMPANYCODE AND A.LOCATIONCODE=B.LOCATIONCODE AND A.EMPLOYEECODE=B.EMPLOYEECODE       
    )
GROUP BY COMPANYCODE, DIVISIONCODE, YEARCODE, YEARMONTH, CATEGORYCODE, GRADECODE,EMPLOYEECODE, PFNO




-------------------------------------------------------------------------------------------------

SELECT COMPANYCODE, DIVISIONCODE, YEARCODE, YEARMONTH, CATEGORYCODE, GRADECODE, '7'||EMPLOYEECODE EMPLOYEECODE, PFNO,
SUM(ATTN_SALD) ATTN_SALD, SUM(NCP_DAYS) NCP_DAYS, SUM(GROSSWAGES) GROSSWAGES, SUM(PF_GROSS) PF_GROSS,
CASE WHEN SUM(EPF)<=0 then 0 ELSE CASE WHEN SUM(PF_GROSS)>=15000 THEN 15000 ELSE SUM(PF_GROSS) END END PEN_GROSS,
SUM(ESI_GROSS) ESI_GROSS, SUM(PTAX_GROSS) PTAX_GROSS, SUM(PF_E) PF_E, SUM(EPF) EPF, SUM(PF_C) PF_C, SUM(PTAX) PTAX,
SUM(ESI_E) ESI_E, SUM(ESI_C) ESI_C, SUM(LOAN_MPL) LOAN_MPL, SUM(LINT_MPL) LINT_MPL
FROM (
        SELECT A.COMPANYCODE, A.LOCATIONCODE DIVISIONCODE, A.YEARCODE, A.YEARMONTH, A.CATEGORYCODE, A.GRADECODE,A.EMPLOYEECODE, B.EMPLOYEEPFACCNUMBER PFNO,
        DECODE(A.COMPONENTCODE,'ATTN.TOTD', COMPONENTAMOUNT,0) ATTN_SALD, DECODE(A.COMPONENTCODE,'ATTN.WPAY', COMPONENTAMOUNT,0) NCP_DAYS,
        DECODE(A.COMPONENTCODE,'GROSSEARN', COMPONENTAMOUNT,0) GROSSWAGES,DECODE(A.COMPONENTCODE,'PFGROSS', COMPONENTAMOUNT,0) PF_GROSS, 
        DECODE(A.COMPONENTCODE,'GROSS_ESI', COMPONENTAMOUNT,0) ESI_GROSS, DECODE(A.COMPONENTCODE,'GROSSPTAX', COMPONENTAMOUNT,0) PTAX_GROSS,
        DECODE(A.COMPONENTCODE,'PF_E', COMPONENTAMOUNT,0) PF_E, DECODE(A.COMPONENTCODE,'EPF', COMPONENTAMOUNT,0) EPF,
        DECODE(A.COMPONENTCODE,'PF_C', COMPONENTAMOUNT,0) PF_C, DECODE(A.COMPONENTCODE,'PTAX', COMPONENTAMOUNT,0) PTAX,
        DECODE(A.COMPONENTCODE,'ESI_E', COMPONENTAMOUNT,0) ESI_E, DECODE(A.COMPONENTCODE,'ESI_C', COMPONENTAMOUNT,0) ESI_C,
        DECODE(A.COMPONENTCODE,'LOAN.PF', COMPONENTAMOUNT,0) LOAN_MPL, DECODE(A.COMPONENTCODE,'LINT.PF', COMPONENTAMOUNT,0) LINT_MPL
        FROM PISEMPLOYEEPAYTRANSACTION A, PISEMPLOYEEMASTER B
        WHERE A.COMPANYCODE='NJ0001' AND A.LOCATIONCODE='0002'
          AND A.YEARMONTH='202010'
          AND A.COMPONENTCODE IN ('ATTN.TOTD','ATTN.WPAY','GROSSEARN','PFGROSS','GROSS_ESI', 'GROSSPTAX','PF_E','EPF','PF_C','PTAX','ESI_E','ESI_C','LOAN.PF','LINT.PF')
          AND A.COMPANYCODE= B.COMPANYCODE AND A.LOCATIONCODE=B.LOCATIONCODE AND A.EMPLOYEECODE=B.EMPLOYEECODE       
        UNION ALL
        SELECT A.COMPANYCODE, A.LOCATIONCODE DIVISIONCODE, A.YEARCODE, A.YEARMONTH, A.CATEGORYCODE, A.GRADECODE, A.EMPLOYEECODE, B.EMPLOYEEPFACCNUMBER PFNO,
        DECODE(A.COMPONENTCODE,'ATTN.TOTD', COMPONENTAMOUNT,0) ATTN_SALD, DECODE(A.COMPONENTCODE,'ATTN.WPAY', COMPONENTAMOUNT,0) NCP_DAYS,
        DECODE(A.COMPONENTCODE,'GROSSEARN', COMPONENTAMOUNT,0) GROSSWAGES,DECODE(A.COMPONENTCODE,'PFGROSS', COMPONENTAMOUNT,0) PF_GROSS, 
        DECODE(A.COMPONENTCODE,'GROSS_ESI', COMPONENTAMOUNT,0) ESI_GROSS, DECODE(A.COMPONENTCODE,'GROSSPTAX', COMPONENTAMOUNT,0) PTAX_GROSS,
        DECODE(A.COMPONENTCODE,'PF_E', COMPONENTAMOUNT,0) PF_E, DECODE(A.COMPONENTCODE,'EPF', COMPONENTAMOUNT,0) EPF,
        DECODE(A.COMPONENTCODE,'PF_C', COMPONENTAMOUNT,0) PF_C, DECODE(A.COMPONENTCODE,'PTAX', COMPONENTAMOUNT,0) PTAX,
        DECODE(A.COMPONENTCODE,'ESI_E', COMPONENTAMOUNT,0) ESI_E, DECODE(A.COMPONENTCODE,'ESI_C', COMPONENTAMOUNT,0) ESI_C,
        DECODE(A.COMPONENTCODE,'LOAN.PFL', COMPONENTAMOUNT,0) LOAN_MPL, DECODE(A.COMPONENTCODE,'LINT.PFL', COMPONENTAMOUNT,0) LINT_MPL
        FROM PISEMPLOYEEPAYTRANSACTION A, PISEMPLOYEEMASTER B
        WHERE A.COMPANYCODE='NJ0001' AND A.LOCATIONCODE='0001'
          AND A.YEARMONTH='202010'
          AND A.CATEGORYCODE='2'
          AND A.COMPONENTCODE IN ('ATTN.TOTD','ATTN.WPAY','GROSSEARN','PFGROSS','GROSS_ESI', 'GROSSPTAX','PF_E','EPF','PF_C','PTAX','ESI_E','ESI_C','LOAN.PFL','LINT.PFL')
          AND A.COMPANYCODE= B.COMPANYCODE AND A.LOCATIONCODE=B.LOCATIONCODE AND A.EMPLOYEECODE=B.EMPLOYEECODE       
    )
WHERE EMPLOYEECODE='1178'   
GROUP BY COMPANYCODE, DIVISIONCODE, YEARCODE, YEARMONTH, CATEGORYCODE, GRADECODE,EMPLOYEECODE, PFNO



SELECT * FROM PISEMPLOYEEPAYTRANSACTION WHERE EMPLOYEECODE='1178'

  AND YEARMONTH='202010'


